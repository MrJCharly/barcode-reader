<ion-header>
  <ion-navbar>
    <ion-title>
      Preparar pedido
    </ion-title>
  </ion-navbar>
</ion-header>

<ion-content padding>
  <h3>{{global.curr_branch.name}}</h3>

  <br/>
  <button ion-button block (click)="getUserByBarcode()">Identificar Usuario</button>
  <button ion-button round block outline small (click)="promptUsuario()">Ingreso manual de usuario</button>

  <br/>
  <ion-card *ngIf="user">
    <ion-item>
      <ion-avatar item-start>
        <ion-icon name="person"></ion-icon>
      </ion-avatar>
      <h2>{{user.name}} {{user.last_name}}</h2>
      <p>DNI {{user.identification_number}}</p>
    </ion-item>
  </ion-card>

  <ion-card *ngIf="!user">
    <ion-item>
      <ion-avatar item-start>
        <ion-icon name="person"></ion-icon>
      </ion-avatar>
      <h2>Usuario no identificado</h2>
      <p></p>
    </ion-item>
  </ion-card>

  <br/>
  <button ion-button block (click)="addItemByBarcode()">Agregar elemento</button>
  <button ion-button round block outline small (click)="addItemByCode()">Ingreso manual de elemento</button>

  <ion-list>
    <!-- Mensaje de lista vacía -->
    <ion-item *ngIf="items && items.length == 0">
      Agregar ítems a la lista.
    </ion-item>

    <!-- Lista de ítems -->
    <ion-item *ngFor="let item of items">
      <ion-icon name="remove-circle" item-start (click)="setQty(item, -1)"></ion-icon>
        {{item.product.name}} / {{item.qty}}u
      <ion-icon name="add-circle" item-end (click)="setQty(item, 1)"></ion-icon>
    </ion-item>
  </ion-list>

  <!-- Firma de usuario
    <draw-signature-pad [signature]="signature" (onSignatureChange)="onValueChange($event)"></draw-signature-pad>
  -->
  <ion-card>
    <ion-card-content>
      <ion-row>
        <ion-col>
          <signature-pad [options]="options"></signature-pad>
        </ion-col>
      </ion-row>
      <button ion-button small color="calm" (click)="clear()">Borrar</button>
    </ion-card-content>
  </ion-card>
</ion-content>

<ion-footer>
  <ion-row>
    <button ion-button block color="secondary" icon-start [disabled]="!isFormValid()" (click)="onSubmit()">
      <ion-icon name="checkmark"></ion-icon>
      Finalizar
    </button>
    <button ion-button block color="danger" icon-start [disabled]="!canCancel()" (click)="onCancel()">
      <ion-icon name="remove-circle"></ion-icon>
      Cancelar
    </button>
  </ion-row>
</ion-footer>
